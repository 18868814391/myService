(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b77d1ba"],{"2e3a":function(t,s,a){"use strict";a.r(s);var n,e=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"chat-page"},[a("div",{staticClass:"chat-page-head"},[t._v("\n    当前在线人数"+t._s(t.num)+"\n    ")]),a("div",{staticClass:"chat-page-body",attrs:{id:"msg_box"}},[t._l(t.histortist,function(s,n){return a("div",{key:n,staticClass:"chatMsg"},[s.adm!=t.admin?a("div",{staticClass:"chatMsg-t1"},[t._v(t._s(s.Thename)+"说：")]):t._e(),s.adm!=t.admin?a("div",{staticClass:"chatMsg-t2"},[t._v(t._s(s.updataTime))]):t._e(),s.adm!=t.admin?a("div",{staticClass:"chatMsg-t3"},[t._v(t._s(s.content))]):t._e(),s.adm==t.admin?a("div",{staticClass:"chatMsg-t1 al gb"},[t._v(t._s(s.Thename)+"说：")]):t._e(),s.adm==t.admin?a("div",{staticClass:"chatMsg-t2 al gb"},[t._v(t._s(s.updataTime))]):t._e(),s.adm==t.admin?a("div",{staticClass:"chatMsg-t3 al gb"},[t._v(t._s(s.content))]):t._e()])}),a("div",{staticClass:"historyRecord"},[t._v("————历史纪录————")]),t._l(t.chatList,function(s,n){return a("div",{key:n,staticClass:"chatMsg"},[s.adm!=t.admin?a("div",{staticClass:"chatMsg-t1"},[t._v(t._s(s.Thename)+"说：")]):t._e(),s.adm!=t.admin?a("div",{staticClass:"chatMsg-t2"},[t._v(t._s(s.updataTime))]):t._e(),s.adm!=t.admin?a("div",{staticClass:"chatMsg-t3"},[t._v(t._s(s.content))]):t._e(),s.adm==t.admin?a("div",{staticClass:"chatMsg-t1 al gb"},[t._v(t._s(s.Thename)+"说：")]):t._e(),s.adm==t.admin?a("div",{staticClass:"chatMsg-t2 al gb"},[t._v(t._s(s.updataTime))]):t._e(),s.adm==t.admin?a("div",{staticClass:"chatMsg-t3 al gb"},[t._v(t._s(s.content))]):t._e()])})],2),a("div",{staticClass:"chat-page-bottom"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.con,expression:"con"}],attrs:{type:"text",name:"",id:""},domProps:{value:t.con},on:{input:function(s){s.target.composing||(t.con=s.target.value)}}}),a("div",{staticClass:"sendop"},[a("div",{staticClass:"sendop-b1",on:{click:function(s){t.show=!t.show}}},[t._v("颜艺")]),a("button",{on:{click:t.send}},[t._v("发送")])])]),a("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[a("div",{staticClass:"emojBox"},t._l(t.emoji,function(s,n){return a("div",{key:n,staticClass:"emojBox-items",on:{click:function(a){return t.selEmoj(s)}}},[t._v("\n        "+t._s(s)+"\n      ")])}),0)])],1)},i=[],o=a("f499"),c=a.n(o),d=a("bd86"),m=(a("7f7f"),a("b970")),l=a("365c"),h=a("5f87"),r=a("c1df"),u=a.n(r),v={components:(n={},Object(d["a"])(n,m["o"].name,m["o"]),Object(d["a"])(n,m["i"].name,m["i"]),n),data:function(){return{show:!1,emoji:["w(ﾟДﾟ)w","ヽ(✿ﾟ▽ﾟ)ノ","(๑•̀ㅂ•́)و✧","(⊙﹏⊙)","┗|｀O′|┛","φ(≧ω≦*)♪","凸(艹皿艹 )","╰(*°▽°*)╯","（´Д`）","(#`O′)","(＠_＠;)","(ー`´ー)"],num:"",histortist:[],chatList:[],admin:Object(h["b"])(),Thename:Object(h["a"])(),con:"",ws:null,hub:"",noAdm:""}},beforeRouteLeave:function(t,s,a){this.ws.close(),a()},created:function(){var t=this;if(!Object(h["b"])()){Object(m["o"])("您尚未登陆，将随机分配您的用户名");var s=(new Date).valueOf();console.log(String(s)),this.noAdm="匿名用户"+String(s).substr(7,10),console.log(this.noAdm),this.admin=this.noAdm,this.Thename=this.noAdm}t.getlatest(),this.ws=new WebSocket("wss://www.shenyifan.top/socket/"),this.ws.onopen=function(){console.log("握手成功")},this.ws.onmessage=function(s){console.log("message:"+s.data),JSON.parse(s.data).content?(t.chatList.push(JSON.parse(s.data)),t.$nextTick(function(){var t=document.getElementById("msg_box");t.scrollTop=t.scrollHeight})):t.num=s.data},this.ws.onerror=function(){Object(m["o"])("socket连接以断开，请刷新页面"),console.log("error")},setTimeout(function(){var s=u()().format("MMMM Do YYYY, h:mm:ss a"),a={adm:t.admin,Thename:t.Thename,content:t.Thename+"加入了聊天室",updataTime:s};t.ws.send(c()(a))},2e3)},methods:{send:function(){if(!this.con)return Object(m["o"])("请输入点什么"),!1;var t=this,s=u()().format("MMMM Do YYYY, h:mm:ss a"),a={adm:t.admin,Thename:t.Thename,content:String(t.con),updataTime:s};this.ws.send(c()(a)),this.con=""},getlatest:function(){var t=this;Object(l["x"])({}).then(function(s){console.log(s),t.histortist=s.data.errmsg,t.histortist.reverse(),console.log(t.histortist)}).catch(function(t){})},selEmoj:function(t){this.con=this.con+t,this.show=!1}}},_=v,g=(a("50dc"),a("2877")),f=Object(g["a"])(_,e,i,!1,null,null,null);s["default"]=f.exports},"50dc":function(t,s,a){"use strict";var n=a("f39a"),e=a.n(n);e.a},f39a:function(t,s,a){}}]);
//# sourceMappingURL=chunk-7b77d1ba.261487b7.js.map