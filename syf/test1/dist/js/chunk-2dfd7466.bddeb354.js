(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2dfd7466"],{"29e2":function(s,t,e){},4502:function(s,t,e){"use strict";e.r(t);var n=function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"IM-page"},[e("div",{staticClass:"IM-Nav"},[e("div",{on:{click:function(t){return s.changeNav(1)}}},[s._v("最近会话")]),e("div",{on:{click:function(t){return s.changeNav(2)}}},[s._v("通讯录")]),e("div",{on:{click:function(t){return s.changeNav(3)}}},[s._v("设置")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:1==s.navType,expression:"navType==1"}]},[s._l(s.data.sessions,function(t,n){return e("div",{directives:[{name:"show",rawName:"v-show",value:!s.chating,expression:"!chating"}],key:n,staticClass:"IM-sessions",on:{click:function(e){return s.goChat(t.id,t)}}},["p2p"==t.scene?e("div",[e("div",{staticClass:"IM-sessions-t1"},[s._v(s._s(t.to))]),"text"==t.lastMsg.type?e("div",{staticClass:"IM-sessions-t2"},[s._v(" "+s._s(t.lastMsg.text))]):s._e(),"text"!=t.lastMsg.type?e("div",{staticClass:"IM-sessions-t2"},[s._v(" ["+s._s(t.lastMsg.type)+"]")]):s._e()]):s._e(),"team"==t.scene?e("div",[e("div",{staticClass:"IM-sessions-t1"},[s._v("群消息")]),"text"==t.lastMsg.type?e("div",{staticClass:"IM-sessions-t2"},[s._v(" "+s._s(t.lastMsg.fromNick)+"："+s._s(t.lastMsg.text))]):s._e(),"text"!=t.lastMsg.type?e("div",{staticClass:"IM-sessions-t2"},[s._v(" ["+s._s(t.lastMsg.type)+"]")]):s._e()]):s._e(),e("div",{staticClass:"IM-sessions-t3"},[s._v(s._s(s.timeString(t.updateTime)))])])}),e("button",{directives:[{name:"show",rawName:"v-show",value:s.chating,expression:"chating"}],staticClass:"backButton",on:{click:function(t){s.chating=!s.chating}}},[s._v("后退")]),e("div",{directives:[{name:"show",rawName:"v-show",value:s.chating,expression:"chating"}],staticClass:"chat-rom"},s._l(s.chatData,function(t,n){return e("div",{key:n,staticClass:"chat-List",class:"out"==t.flow?"chat-List-r":""},[e("div",{staticClass:"chat-List-t"},[s._v(s._s(t.fromNick))]),e("div",{staticClass:"chat-List-c",class:"out"==t.flow?"chat-List-c-r":""},[s._v(s._s(t.text))])])}),0),e("div",{directives:[{name:"show",rawName:"v-show",value:s.chating,expression:"chating"}],staticClass:"chat-input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.sendMsg,expression:"sendMsg"}],attrs:{type:"text",name:"",id:""},domProps:{value:s.sendMsg},on:{input:function(t){t.target.composing||(s.sendMsg=t.target.value)}}}),e("button",{on:{click:s.send}},[s._v("发送")])]),e("div",{staticStyle:{height:"100px"}})],2),e("div",{directives:[{name:"show",rawName:"v-show",value:2==s.navType,expression:"navType==2"}]},[s._m(0),e("div",{staticClass:"album-b2"},[e("div",[s._v("群")]),s._l(s.data.teams,function(t,n){return e("div",{key:n},[s._v("\n\t\t\t\t"+s._s(t.name)+"\n\t\t\t")])}),e("hr")],2),e("div",{staticClass:"album-b2"},[e("div",[s._v("好友列表")]),s._l(s.data.users,function(t,n){return e("div",{key:n},[s._v("\n\t\t\t\t"+s._s(t.nick)+"\n\t\t\t")])}),e("hr")],2),s._m(1),s._m(2)])])},i=[function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"album-b1"},[e("button",[s._v("添加好友/群")]),e("button",[s._v("创建组/群")])])},function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"album-b2"},[e("div",[s._v("机器人")]),e("hr")])},function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"album-b2"},[e("div",[s._v("黑名单")]),e("hr")])}],o=e("f499"),a=e.n(o),c=e("a745"),l=e.n(c),d=e("e814"),r=e.n(d),h=(e("5f87"),{data:function(){return{navType:2,chating:!1,data:{},nim:null,timer:null,openChatRoom:!1,chatItem:"",chatId:"",chatAdmin:"",chatData:null,sendMsg:""}},beforeDestroy:function(){var s=this;clearInterval(s.timer)},created:function(){var s=this,t=SDK.NIM.getInstance({appKey:"45c6af3c98409b18a84451215d0bdd6e",account:"pptvvx",token:"153719072fddad21235b126d4f0436dc",onconnect:s.onConnect,onerror:s.onError,onwillreconnect:s.onWillReconnect,ondisconnect:s.onDisconnect,onloginportschange:s.onLoginPortsChange,onblacklist:s.onBlacklist,onsyncmarkinblacklist:s.onMarkInBlacklist,onmutelist:s.onMutelist,onsyncmarkinmutelist:s.onMarkInMutelist,onfriends:s.onFriends,onsyncfriendaction:s.onSyncFriendAction,onmyinfo:s.onMyInfo,onupdatemyinfo:s.onUpdateMyInfo,onusers:s.onUsers,onupdateuser:s.onUpdateUser,onrobots:s.onRobots,onteams:s.onTeams,onsynccreateteam:s.onCreateTeam,onUpdateTeam:s.onUpdateTeam,onteammembers:s.onTeamMembers,onupdateteammember:s.onUpdateTeamMember,onTeamMsgReceipt:s.onTeamMsgReceipt,onsessions:s.onSessions,onupdatesession:s.onUpdateSession,onroamingmsgs:s.onRoamingMsgs,onofflinemsgs:s.onOfflineMsgs,onmsg:s.onMsg,onofflinesysmsgs:s.onOfflineSysMsgs,onsysmsg:s.onSysMsg,onupdatesysmsg:s.onUpdateSysMsg,onsysmsgunread:s.onSysMsgUnread,onupdatesysmsgunread:s.onUpdateSysMsgUnread,onofflinecustomsysmsgs:s.onOfflineCustomSysMsgs,oncustomsysmsg:s.onCustomSysMsg,onbroadcastmsg:s.onBroadcastMsg,onbroadcastmsgs:s.onBroadcastMsgs,onsyncdone:s.onSyncDone});this.nim=t},methods:{changeNav:function(s){this.navType=s},timeString:function(s){return new Date(r()(s)).toLocaleString().substr(0,22)},goChat:function(s,t){this.chating=!0,"p2p"==t.scene?(this.chatId=s,this.chatItem=t,t&&t.to&&(this.chatAdmin=t.to),this.chatData=this.data.msgs[t.id]):"team"==t.scene&&(this.chatId=t.to,this.chatItem=t,t&&t.to&&(this.chatAdmin=t.to),console.log(22222222,this.data.msgs),console.log(11111,s),this.chatData=this.data.msgs[t.id],console.log(333333,this.chatData)),setTimeout(function(){document.documentElement.scrollTop=document.documentElement.scrollHeight},10)},send:function(){if("p2p"==this.chatItem.scene){var s=this;s.nim.sendText({scene:"p2p",to:s.chatAdmin,text:s.sendMsg,done:s.sendMsgDone});console.log("正在发送消息",s.sendMsg,"发送对象",s.chatAdmin)}else if("team"==this.chatItem.scene){var t=this;t.nim.sendText({scene:"team",to:t.chatAdmin,text:t.sendMsg,done:t.sendMsgDone});console.log("正在发送消息",t.sendMsg,"发送对象",t.chatAdmin)}},sendMsgDone:function(s,t){console.log(s),console.log(t),console.log("发送"+t.scene+" "+t.type+"消息"+(s?"失败":"成功")+", id="+t.idClient),this.sendMsg="",this.pushMsg(t),console.log(123456789,this.chatId,this.chatItem),this.goChat(this.chatId,this.chatItem)},onConnect:function(){console.log("连接成功"),console.log("nim实例",this.nim)},onWillReconnect:function(s){console.log("即将重连"),console.log(s.retryCount),console.log(s.duration)},onDisconnect:function(s){if(console.log("丢失连接"),console.log(s),s)switch(s.code){case 302:break;case"kicked":break;default:break}},onError:function(s){console.log(s)},onLoginPortsChange:function(s){console.log("当前登录帐号在其它端的状态发生改变了",s)},onBlacklist:function(s){console.log("收到黑名单",s),this.data.blacklist=this.nim.mergeRelations(this.data.blacklist,s),this.data.blacklist=this.nim.cutRelations(this.data.blacklist,s.invalid),this.refreshBlacklistUI()},onMarkInBlacklist:function(s){console.log(s),console.log(s.account+"被你在其它端"+(s.isAdd?"加入":"移除")+"黑名单"),s.isAdd?this.addToBlacklist(s):this.removeFromBlacklist(s)},addToBlacklist:function(s){this.data.blacklist=this.nim.mergeRelations(this.data.blacklist,s.record),this.refreshBlacklistUI()},removeFromBlacklist:function(s){this.data.blacklist=this.nim.cutRelations(this.data.blacklist,s.record),this.refreshBlacklistUI()},refreshBlacklistUI:function(){},onMutelist:function(s){console.log("收到静音列表",s),this.data.mutelist=this.nim.mergeRelations(this.data.mutelist,s),this.data.mutelist=this.nim.cutRelations(this.data.mutelist,s.invalid),this.refreshMutelistUI()},onMarkInMutelist:function(s){console.log(s),console.log(s.account+"被你"+(s.isAdd?"加入":"移除")+"静音列表"),s.isAdd?this.addToMutelist(s):this.removeFromMutelist(s)},addToMutelist:function(s){this.data.mutelist=this.nim.mergeRelations(this.data.mutelist,s.record),this.refreshMutelistUI()},removeFromMutelist:function(s){this.data.mutelist=this.nim.cutRelations(this.data.mutelist,s.record),this.refreshMutelistUI()},refreshMutelistUI:function(){},onFriends:function(s){console.log("收到好友列表",s),this.data.friends=this.nim.mergeFriends(this.data.friends,s),this.data.friends=this.nim.cutFriends(this.data.friends,s.invalid),this.refreshFriendsUI()},onSyncFriendAction:function(s){switch(console.log(s),s.type){case"addFriend":console.log("你在其它端直接加了一个好友"+s.account+", 附言"+s.ps),this.onAddFriend(s.friend);break;case"applyFriend":console.log("你在其它端申请加了一个好友"+s.account+", 附言"+s.ps);break;case"passFriendApply":console.log("你在其它端通过了一个好友申请"+s.account+", 附言"+s.ps),this.onAddFriend(s.friend);break;case"rejectFriendApply":console.log("你在其它端拒绝了一个好友申请"+s.account+", 附言"+s.ps);break;case"deleteFriend":console.log("你在其它端删了一个好友"+s.account),this.onDeleteFriend(s.account);break;case"updateFriend":console.log("你在其它端更新了一个好友",s.friend),this.onUpdateFriend(s.friend);break}},onAddFriend:function(s){this.data.friends=this.nim.mergeFriends(this.data.friends,s),this.refreshFriendsUI()},onDeleteFriend:function(s){this.data.friends=this.nim.cutFriendsByAccounts(this.data.friends,s),this.refreshFriendsUI()},onUpdateFriend:function(s){this.data.friends=this.nim.mergeFriends(this.data.friends,s),this.refreshFriendsUI()},refreshFriendsUI:function(){},onMyInfo:function(s){console.log("收到我的名片",s),this.data.myInfo=s,this.updateMyInfoUI()},onUpdateMyInfo:function(s){console.log("我的名片更新了",s),this.data.myInfo=NIM.util.merge(this.data.myInfo,s),this.updateMyInfoUI()},updateMyInfoUI:function(){},onUsers:function(s){console.log("收到用户名片列表",s),this.data.users=this.nim.mergeUsers(this.data.users,s)},onUpdateUser:function(s){console.log("用户名片更新了",s),this.data.users=this.nim.mergeUsers(this.data.users,s)},onRobots:function(s){console.log("收到机器人列表",s),this.data.robots=s},onTeams:function(s){console.log("群列表",s),this.data.teams=this.nim.mergeTeams(this.data.teams,s),this.onInvalidTeams(s.invalid)},onInvalidTeams:function(s){this.data.teams=this.nim.cutTeams(this.data.teams,s),this.data.invalidTeams=this.nim.mergeTeams(this.data.invalidTeams,s),this.refreshTeamsUI()},onCreateTeam:function(s){console.log("你创建了一个群",s),this.data.teams=this.nim.mergeTeams(this.data.teams,s),this.refreshTeamsUI(),this.onTeamMembers({teamId:s.teamId,members:owner})},refreshTeamsUI:function(){},onTeamMembers:function(s,t){console.log("群id",s,"群成员",t);s=obj.teamId,t=obj.members;this.data.teamMembers=this.data.teamMembers||{},this.data.teamMembers[s]=this.nim.mergeTeamMembers(this.data.teamMembers[s],t),this.data.teamMembers[s]=this.nim.cutTeamMembers(this.data.teamMembers[s],t.invalid),this.refreshTeamMembersUI()},onSyncTeamMembersDone:function(){console.log("同步群列表完成")},onUpdateTeam:function(s){console.log("群状态更新",s)},onUpdateTeamMember:function(s){console.log("群成员信息更新了",s),this.onTeamMembers({teamId:s.teamId,members:s})},refreshTeamMembersUI:function(){},onTeamMsgReceipt:function(s){console.log("群消息已读通知",s)},onSessions:function(s){console.log("收到会话列表",s),this.data.sessions=this.nim.mergeSessions(this.data.sessions,s),this.updateSessionsUI()},onUpdateSession:function(s){console.log("会话更新了",s),this.data.sessions=this.nim.mergeSessions(this.data.sessions,s),this.updateSessionsUI(),console.log("data更新",this.data)},updateSessionsUI:function(){},onRoamingMsgs:function(s){console.log("漫游消息",s),this.pushMsg(s.msgs)},onOfflineMsgs:function(s){console.log("离线消息",s),this.pushMsg(s.msgs)},onMsg:function(s){console.log("收到消息",s.scene,s.type,s),this.pushMsg(s),this.chating&&this.goChat(this.chatId,this.chatItem),console.log("data更新",this.data)},onBroadcastMsg:function(s){console.log("收到广播消息",s)},onBroadcastMsgs:function(s){console.log("收到广播消息列表",s)},pushMsg:function(s){l()(s)||(s=[s]);var t=s[0].sessionId;this.data.msgs=this.data.msgs||{},this.data.msgs[t]=this.nim.mergeMsgs(this.data.msgs[t],s)},onOfflineSysMsgs:function(s){console.log("收到离线系统通知",s),this.pushSysMsgs(s)},onSysMsg:function(s){console.log("收到系统通知",s),this.pushSysMsgs(s)},onUpdateSysMsg:function(s){this.pushSysMsgs(s)},pushSysMsgs:function(s){this.data.sysMsgs=this.nim.mergeSysMsgs(this.data.sysMsgs,s),this.refreshSysMsgsUI()},onSysMsgUnread:function(s){console.log("收到系统通知未读数",s),this.data.sysMsgUnread=s,this.refreshSysMsgsUI()},onUpdateSysMsgUnread:function(s){console.log("系统通知未读数更新了",s),this.data.sysMsgUnread=s,this.refreshSysMsgsUI()},refreshSysMsgsUI:function(){},onOfflineCustomSysMsgs:function(s){console.log("收到离线自定义系统通知",s)},onCustomSysMsg:function(s){console.log("收到自定义系统通知",s)},onSyncDone:function(){console.log("同步完成",this.data),this.timeOBJ()},timeOBJ:function(){var s=this;this.timer=setTimeout(function(){var t=a()(s.data);s.data=null,s.data=JSON.parse(t)},100)}}}),m=h,u=(e("e145"),e("2877")),g=Object(u["a"])(m,n,i,!1,null,null,null);t["default"]=g.exports},e145:function(s,t,e){"use strict";var n=e("29e2"),i=e.n(n);i.a}}]);
//# sourceMappingURL=chunk-2dfd7466.bddeb354.js.map