(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1a421da1"],{"24c5":function(t,e,n){"use strict";var i,o,r,a,s=n("b8e3"),c=n("e53d"),u=n("d864"),h=n("40c3"),l=n("63b6"),f=n("f772"),v=n("79aa"),d=n("1173"),m=n("a22a"),p=n("f201"),g=n("4178").set,w=n("aba2")(),y=n("656e"),x=n("4439"),_=n("bc13"),b=n("cd78"),A="Promise",D=c.TypeError,C=c.process,k=C&&C.versions,P=k&&k.v8||"",I=c[A],N="process"==h(C),U=function(){},j=o=y.f,M=!!function(){try{var t=I.resolve(1),e=(t.constructor={})[n("5168")("species")]=function(t){t(U,U)};return(N||"function"==typeof PromiseRejectionEvent)&&t.then(U)instanceof e&&0!==P.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(t){}}(),S=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},T=function(h,n){if(!h._n){h._n=!0;var i=h._c;w(function(){for(var c=h._v,u=1==h._s,t=0,e=function(t){var e,n,i,o=u?t.ok:t.fail,r=t.resolve,a=t.reject,s=t.domain;try{o?(u||(2==h._h&&L(h),h._h=1),!0===o?e=c:(s&&s.enter(),e=o(c),s&&(s.exit(),i=!0)),e===t.promise?a(D("Promise-chain cycle")):(n=S(e))?n.call(e,r,a):r(e)):a(c)}catch(t){s&&!i&&s.exit(),a(t)}};i.length>t;)e(i[t++]);h._c=[],h._n=!1,n&&!h._h&&W(h)})}},W=function(r){g.call(c,function(){var t,e,n,i=r._v,o=O(r);if(o&&(t=x(function(){N?C.emit("unhandledRejection",i,r):(e=c.onunhandledrejection)?e({promise:r,reason:i}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",i)}),r._h=N||O(r)?2:1),r._a=void 0,o&&t.e)throw t.v})},O=function(t){return 1!==t._h&&0===(t._a||t._c).length},L=function(e){g.call(c,function(){var t;N?C.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})})},E=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),T(e,!0))},R=function(t){var n,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw D("Promise can't be resolved itself");(n=S(t))?w(function(){var e={_w:i,_d:!1};try{n.call(t,u(R,e,1),u(E,e,1))}catch(t){E.call(e,t)}}):(i._v=t,i._s=1,T(i,!1))}catch(t){E.call({_w:i,_d:!1},t)}}};M||(I=function(t){d(this,I,A,"_h"),v(t),i.call(this);try{t(u(R,this,1),u(E,this,1))}catch(t){E.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n("5c95")(I.prototype,{then:function(t,e){var n=j(p(this,I));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=N?C.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&T(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new i;this.promise=t,this.resolve=u(R,t,1),this.reject=u(E,t,1)},y.f=j=function(t){return t===I||t===a?new r(t):o(t)}),l(l.G+l.W+l.F*!M,{Promise:I}),n("45f2")(I,A),n("4c95")(A),a=n("584a")[A],l(l.S+l.F*!M,A,{reject:function(t){var e=j(this);return(0,e.reject)(t),e.promise}}),l(l.S+l.F*(s||!M),A,{resolve:function(t){return b(s&&this===a?I:this,t)}}),l(l.S+l.F*!(M&&n("4ee1")(function(t){I.all(t).catch(U)})),A,{all:function(t){var a=this,e=j(a),s=e.resolve,c=e.reject,n=x(function(){var i=[],o=0,r=1;m(t,!1,function(t){var e=o++,n=!1;i.push(void 0),r++,a.resolve(t).then(function(t){n||(n=!0,i[e]=t,--r||s(i))},c)}),--r||s(i)});return n.e&&c(n.v),e.promise},race:function(t){var e=this,n=j(e),i=n.reject,o=x(function(){m(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return o.e&&i(o.v),n.promise}})},3024:function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},"3c11":function(t,e,n){"use strict";var i=n("63b6"),o=n("584a"),r=n("e53d"),a=n("f201"),s=n("cd78");i(i.P+i.R,"Promise",{finally:function(e){var n=a(this,o.Promise||r.Promise),t="function"==typeof e;return this.then(t?function(t){return s(n,e()).then(function(){return t})}:e,t?function(t){return s(n,e()).then(function(){throw t})}:e)}})},"3f7e":function(t,e,n){"use strict";var i=n("c8ad");n.n(i).a},4178:function(t,e,n){var i,o,r,a=n("d864"),s=n("3024"),c=n("32fc"),u=n("1ec9"),h=n("e53d"),l=h.process,f=h.setImmediate,v=h.clearImmediate,d=h.MessageChannel,m=h.Dispatch,p=0,g={},w="onreadystatechange",y=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},x=function(t){y.call(t.data)};f&&v||(f=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++p]=function(){s("function"==typeof t?t:Function(t),e)},i(p),p},v=function(t){delete g[t]},"process"==n("6b4c")(l)?i=function(t){l.nextTick(a(y,t,1))}:m&&m.now?i=function(t){m.now(a(y,t,1))}:d?(r=(o=new d).port2,o.port1.onmessage=x,i=a(r.postMessage,r,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(i=function(t){h.postMessage(t+"","*")},h.addEventListener("message",x,!1)):i=w in u("script")?function(t){c.appendChild(u("script"))[w]=function(){c.removeChild(this),y.call(t)}}:function(t){setTimeout(a(y,t,1),0)}),t.exports={set:f,clear:v}},"43fc":function(t,e,n){"use strict";var i=n("63b6"),o=n("656e"),r=n("4439");i(i.S,"Promise",{try:function(t){var e=o.f(this),n=r(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},4439:function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},"656e":function(t,e,n){"use strict";var o=n("79aa");function i(t){var n,i;this.promise=new t(function(t,e){if(void 0!==n||void 0!==i)throw TypeError("Bad Promise constructor");n=t,i=e}),this.resolve=o(n),this.reject=o(i)}t.exports.f=function(t){return new i(t)}},"696e":function(t,e,n){n("c207"),n("1654"),n("6c1c"),n("24c5"),n("3c11"),n("43fc"),t.exports=n("584a").Promise},"795b":function(t,e,n){t.exports=n("696e")},aba2:function(t,e,n){var s=n("e53d"),c=n("4178").set,u=s.MutationObserver||s.WebKitMutationObserver,h=s.process,l=s.Promise,f="process"==n("6b4c")(h);t.exports=function(){var n,i,o,t=function(){var t,e;for(f&&(t=h.domain)&&t.exit();n;){e=n.fn,n=n.next;try{e()}catch(t){throw n?o():i=void 0,t}}i=void 0,t&&t.enter()};if(f)o=function(){h.nextTick(t)};else if(!u||s.navigator&&s.navigator.standalone)if(l&&l.resolve){var e=l.resolve(void 0);o=function(){e.then(t)}}else o=function(){c.call(s,t)};else{var r=!0,a=document.createTextNode("");new u(t).observe(a,{characterData:!0}),o=function(){a.data=r=!r}}return function(t){var e={fn:t,next:void 0};i&&(i.next=e),n||(n=e,o()),i=e}}},bc13:function(t,e,n){var i=n("e53d").navigator;t.exports=i&&i.userAgent||""},c281:function(t,e,n){"use strict";n.r(e);var i,o=n("795b"),c=n.n(o),r=(n("4917"),n("28a5"),n("3b2b"),n("a481"),n("bd86")),a=(n("7f7f"),n("a78e"),n("c1df")),s=n.n(a),u=n("365c"),h=n("b970"),l={components:(i={},Object(r.a)(i,h.o.name,h.o),Object(r.a)(i,h.i.name,h.i),i),data:function(){return{show1:!1,show2:!1,upImg:"",upname:"",upmsg:"",colors:["#fef4ac","#0018ba","#ffc200","#f32f15","#cccccc","#5ab639"],brushs:[{className:"small fa fa-paint-brush",lineWidth:3,name:"细"},{className:"middle fa fa-paint-brush",lineWidth:6,name:"中"},{className:"big fa fa-paint-brush",lineWidth:12,name:"粗"}],context:{},imgUrl:[],canvasMoveUse:!0,preDrawAry:[],nextDrawAry:[],middleAry:[],config:{lineWidth:1,lineColor:"#f2849e",shadowBlur:2}}},created:function(){this.$emit("setNav","在线涂鸦画板")},mounted:function(){var t=document.querySelector("#canvas");this.context=t.getContext("2d"),this.initDraw(),this.setCanvasStyle(),document.querySelector("#footer").classList.add("hide-footer"),document.querySelector("body").classList.add("fix-body")},destroyed:function(){document.querySelector("#footer").classList.remove("hide-footer"),document.querySelector("body").classList.remove("fix-body")},computed:{controls:function(){return[{title:"上一步",action:"prev",className:this.preDrawAry.length?"active fa fa-reply":"fa fa-reply",name:"prev"},{title:"下一步",action:"next",className:this.nextDrawAry.length?"active fa fa-share":"fa fa-share",name:"next"},{title:"清除",action:"clear",className:this.preDrawAry.length||this.nextDrawAry.length?"active fa fa-trash":"fa fa-trash",name:"clear"}]}},methods:{isPc:function(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,i=0;i<e.length;i++)if(0<t.indexOf(e[i])){n=!1;break}return n},removeImg:function(e){this.imgUrl=this.imgUrl.filter(function(t){return t!==e})},initDraw:function(){var t=this.context.getImageData(0,0,600,400);this.middleAry.push(t)},canvasMove:function(t){if(this.canvasMoveUse){var e,n,i=t.target;n=this.isPc()?(e=t.clientX-i.parentNode.offsetLeft,t.clientY-i.parentNode.offsetTop):(e=t.changedTouches[0].clientX-i.parentNode.offsetLeft,t.changedTouches[0].clientY-i.parentNode.offsetTop),this.context.lineTo(e,n),this.context.stroke()}},beginPath:function(t){var e=document.querySelector("#canvas");t.target!==e&&this.context.beginPath()},canvasUp:function(t){var e=this.context.getImageData(0,0,600,400);this.nextDrawAry.length?(this.middleAry=[],this.middleAry=this.middleAry.concat(this.preDrawAry),this.middleAry.push(e),this.nextDrawAry=[]):this.middleAry.push(e),this.canvasMoveUse=!1},canvasDown:function(t){this.canvasMoveUse=!0;var e=t.clientX-t.target.parentNode.offsetLeft,n=t.clientY-t.target.parentNode.offsetTop;this.setCanvasStyle(),this.context.beginPath(),this.context.moveTo(e,n);var i=this.context.getImageData(0,0,600,400);this.preDrawAry.push(i)},setColor:function(t){this.config.lineColor=t},setBrush:function(t){this.config.lineWidth=t},controlCanvas:function(t){switch(t){case"prev":if(this.preDrawAry.length){var e=this.preDrawAry.pop(),n=this.middleAry[this.preDrawAry.length+1];this.nextDrawAry.push(n),this.context.putImageData(e,0,0)}break;case"next":if(this.nextDrawAry.length){var i=this.nextDrawAry.pop(),o=this.middleAry[this.middleAry.length-this.nextDrawAry.length-2];this.preDrawAry.push(o),this.context.putImageData(i,0,0)}break;case"clear":this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.preDrawAry=[],this.nextDrawAry=[],this.middleAry=[this.middleAry[0]]}},getImage:function(){var n=this;h.o.loading({mask:!0,message:"处理中..."});var t=document.querySelector("#canvas").toDataURL("image/png");this.imgUrl.push(t),this.compress(t,150,.5).then(function(t){h.o.clear();var e=t;n.upImg=e.replace(new RegExp("\\+","g"),"%2B"),n.show1=!0})},prepre:function(){this.uploadImg()},uploadImg:function(){var e=this,t=s()().format("MMMM Do YYYY, h:mm:ss a");h.o.loading({mask:!0,message:"提交中..."}),Object(u.v)({content:e.upImg,msg:e.upmsg,Thename:e.upname,updataTime:t}).then(function(t){h.o.clear(),e.show2=!1,0==t.data.errcode&&(Object(h.o)("已经上传好了。我留下了。"),e.controlCanvas("clear"))}).catch(function(t){h.o.clear()})},setCanvasStyle:function(){this.context.lineWidth=this.config.lineWidth,this.context.shadowBlur=this.config.shadowBlur,this.context.shadowColor=this.config.lineColor,this.context.strokeStyle=this.config.lineColor},compress:function(n,i,o){var r,a,s=new Image,t=new c.a(function(t){return s.onload=t});return s.src=n,t.then(function(){r=s.width,a=s.height;var t=document.createElement("canvas"),e=t.getContext("2d");return Math.max(r,a)>i?a<r?(t.width=i,t.height=i*a/r):(t.height=i,t.width=i*r/a):(t.width=r,t.height=a),e.clearRect(0,0,t.width,t.height),e.drawImage(s,0,0,t.width,t.height),t.toDataURL(n.split(",")[0].match(/:(.*?);/)[1],o)})}}},f=(n("3f7e"),n("2877")),v=Object(f.a)(l,function(){var n=this,t=n.$createElement,i=n._self._c||t;return i("div",{staticClass:"test1-page"},[i("div",{staticClass:"inner draw",on:{mousemove:function(t){return n.beginPath(t)}}},[i("div",{staticClass:"wrap"},[i("canvas",{staticClass:"fl",attrs:{id:"canvas",width:"600",height:"400"},on:{mousedown:function(t){return n.canvasDown(t)},mouseup:function(t){return n.canvasUp(t)},mousemove:function(t){return n.canvasMove(t)},touchstart:function(t){return n.canvasDown(t)},touchend:function(t){return n.canvasUp(t)},touchmove:function(t){return n.canvasMove(t)}}}),i("div",{staticClass:"fl",attrs:{id:"control"}},[i("div",{attrs:{id:"canvas-color"}},[i("h5",[n._v("\n\t\t\t\t\t\t\t\t\t画笔颜色")]),i("ul",n._l(n.colors,function(e){return i("li",{class:{active:n.config.lineColor===e},style:{background:e},on:{click:function(t){return n.setColor(e)}}})}),0)]),i("div",{attrs:{id:"canvas-brush"}},[i("h5",[n._v("画笔大小")]),n._l(n.brushs,function(e){return i("span",{class:[e.className,{active:n.config.lineWidth===e.lineWidth}],on:{click:function(t){return n.setBrush(e.lineWidth)}}},[n._v(n._s(e.name))])})],2),i("div",{attrs:{id:"canvas-control"}},[i("h5",[n._v("操作")]),n._l(n.controls,function(e){return i("span",{class:e.className,attrs:{title:e.title},on:{click:function(t){return n.controlCanvas(e.action)}}},[n._v(n._s(e.name))])})],2),i("div",{attrs:{id:"canvas-drawImage"}},[i("h5",[n._v("生成图像")]),i("button",{staticClass:"drawImage",on:{click:function(t){return n.getImage()}}},[n._v("预览")])])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:n.imgUrl.length,expression:"imgUrl.length"}],attrs:{id:"img-box"}},n._l(n.imgUrl,function(e){return i("div",{staticClass:"img-item"},[i("img",{attrs:{src:e}}),i("span",{staticClass:"fa fa-close",on:{click:function(t){return n.removeImg(e)}}})])}),0)]),i("div",{directives:[{name:"show",rawName:"v-show",value:n.imgUrl.length,expression:"imgUrl.length"}],attrs:{id:"img-box2"}},n._l(n.imgUrl,function(e){return i("div",{staticClass:"img-item22"},[i("button",{on:{click:function(t){return n.removeImg(e)}}},[n._v("移除")]),i("img",{attrs:{src:e}})])}),0),i("van-popup",{model:{value:n.show1,callback:function(t){n.show1=t},expression:"show1"}},[i("div",{staticClass:"poup1-con"},[i("div",[n._v("给你的大作起个名吧")]),i("input",{directives:[{name:"model",rawName:"v-model",value:n.upname,expression:"upname"}],attrs:{type:"text",name:"",id:""},domProps:{value:n.upname},on:{input:function(t){t.target.composing||(n.upname=t.target.value)}}}),i("div",{staticClass:"poup1-con-op"},[i("button",{on:{click:function(t){n.show1=!n.show1}}},[n._v("取消")]),i("button",{on:{click:function(t){n.show1=!n.show1,n.show2=!0}}},[n._v("确认")])])])]),i("van-popup",{model:{value:n.show2,callback:function(t){n.show2=t},expression:"show2"}},[i("div",{staticClass:"poup1-con"},[i("div",[n._v("来一句介绍吧")]),i("input",{directives:[{name:"model",rawName:"v-model",value:n.upmsg,expression:"upmsg"}],attrs:{type:"text",name:"",id:""},domProps:{value:n.upmsg},on:{input:function(t){t.target.composing||(n.upmsg=t.target.value)}}}),i("div",{staticClass:"poup1-con-op"},[i("button",{on:{click:function(t){n.show2=!n.show2}}},[n._v("取消")]),i("button",{on:{click:function(t){return n.prepre()}}},[n._v("确认")])])])])],1)},[],!1,null,null,null);e.default=v.exports},c8ad:function(t,e,n){},cd78:function(t,e,n){var i=n("e4ae"),o=n("f772"),r=n("656e");t.exports=function(t,e){if(i(t),o(e)&&e.constructor===t)return e;var n=r.f(t);return(0,n.resolve)(e),n.promise}},f201:function(t,e,n){var o=n("e4ae"),r=n("79aa"),a=n("5168")("species");t.exports=function(t,e){var n,i=o(t).constructor;return void 0===i||null==(n=o(i)[a])?e:r(n)}}}]);