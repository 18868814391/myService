(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-44155956"],{"2ae8":function(t,e,s){"use strict";var a=s("9f68");s.n(a).a},"9f68":function(t,e,s){},a78b:function(t,e,s){"use strict";s.r(e);var a=(s("7514"),s("55dd"),s("7f7f"),s("f61f")),r={mounted:function(){this.$store.dispatch("markSysMsgRead"),this.$store.dispatch("markCustomSysMsgRead")},updated:function(){this.$store.dispatch("markSysMsgRead"),this.$store.dispatch("markCustomSysMsgRead")},data:function(){return{sysType:0,defaultAvatar:a.a.defaultUserIcon,deleteIdServer:""}},computed:{userInfos:function(){return this.$store.state.userInfos||{}},sysMsgs:function(){var s=this,t=this.$store.state.sysMsgs.filter(function(t){switch(t.type){case"addFriend":return t.showText="".concat(t.friend.alias||t.friend.account," 添加您为好友~"),t.avatar=s.userInfos[t.from]&&s.userInfos[t.from].avatar,!0;case"deleteFriend":return t.showText="".concat(t.from," 将您从好友中删除"),t.avatar=s.userInfos[t.from].avatar,!1;case"applyTeam":return t.showText=t.from,t.avatar=s.userInfos[t.from]&&s.userInfos[t.from].avatar||s.defaultAvatar,t.desc="申请加入群:".concat(s.getTeamName(t.to)),!0;case"teamInvite":return t.showText=t.attach.team.name,t.avatar=s.userInfos[t.from]&&s.userInfos[t.from].avatar||s.defaultAvatar,t.desc="邀请你加入群".concat(t.to),!0;case"rejectTeamApply":return t.showText=t.attach.team.name,t.desc="管理员拒绝你加入本群",t.avatar=t.attach.team.avatar||s.defaultAvatar,!0;case"rejectTeamInvite":var e=s.userInfos[t.from];return t.showText=e.nick,t.avatar=e.avatar||s.defaultAvatar,t.desc="".concat(e.nick,"拒绝了群").concat(s.getTeamName(t.to),"的入群邀请"),!0}return!1});return t.sort(function(t,e){return e.time-t.time}),t},customSysMsgs:function(){var s=this;return this.$store.state.customSysMsgs.filter(function(t){if("p2p"!==t.scene)return!1;var e=JSON.parse(t.content);return t.showText="".concat(e.content),t.avatar=s.userInfos[t.from].avatar,t})},msgList:function(){return 0===this.sysType?this.sysMsgs:this.customSysMsgs}},methods:{deleteMsg:function(t){this.$store.commit("deleteSysMsgs",{type:this.sysType,idServer:t})},clearMsgs:function(){var t=this;this.$vux.confirm.show({title:"确认要清空消息吗？",onConfirm:function(){t.$store.dispatch("resetSysMsgs",{type:t.sysType})}})},getTeamName:function(e){var t=this.$store.state.teamlist.find(function(t){return t.teamId===e});return t&&t.name||""},handleTeamApply:function(t,e){var s;switch(t.type){case"applyTeam":s=e?"passTeamApply":"rejectTeamApply";break;case"teamInvite":s=e?"acceptTeamInvite":"rejectTeamInvite";break;default:return}this.$store.dispatch("delegateTeamFunction",{functionName:s,options:{idServer:t.idServer,teamId:t.to,from:t.from,done:function(t,e){}}})},findTeamInfo:function(e){var t=this.$store.state.teamlist.find(function(t){return t.teamId===e});return t&&t.name||e},showDelBtn:function(t){var e=this;t&&t.data&&t.data.attrs&&(this.deleteIdServer=t.data.attrs.idServer,this.stopBubble=!0,setTimeout(function(){e.stopBubble=!1},20))},hideDelBtn:function(){return null!==this.deleteIdServer&&!this.stopBubble&&!(this.deleteIdServer=null)}}},i=(s("2ae8"),s("2877")),n=Object(i.a)(r,function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"g-inherit m-article"},[a("x-header",{staticClass:"m-tab",attrs:{"left-options":{backText:" "}}},[a("button-tab",{staticClass:"m-tab-top",model:{value:s.sysType,callback:function(t){s.sysType=t},expression:"sysType"}},[a("button-tab-item",{staticClass:"u-tab-top"},[s._v("系统消息")]),a("button-tab-item",{staticClass:"u-tab-top"},[s._v("自定义消息")])],1),a("a",{attrs:{slot:"left"},slot:"left"}),a("a",{attrs:{slot:"right"},on:{click:function(t){return t.stopPropagation(),s.clearMsgs(t)}},slot:"right"},[s._v("清空")])],1),a("div",{staticClass:"m-article-main p-sysmsgs"},[a("group",{staticClass:"u-list"},[s._l(s.msgList,function(e){return["applyTeam"===e.type||"teamInvite"===e.type?a("cell",{directives:[{name:"touch",rawName:"v-touch:swipeleft",value:s.showDelBtn,expression:"showDelBtn",arg:"swipeleft"},{name:"touch",rawName:"v-touch:swiperight",value:s.hideDelBtn,expression:"hideDelBtn",arg:"swiperight"}],key:e.idServer,staticClass:"u-list-item",attrs:{idServer:e.idServer}},[a("img",{staticClass:"icon",attrs:{slot:"icon",width:"24",src:e.avatar},slot:"icon"}),a("div",{staticClass:"g-teamSys",attrs:{slot:"child"},slot:"child"},[a("div",{staticClass:"m-info"},[a("span",{staticClass:"u-name"},[s._v(s._s(e.from))]),a("span",{staticClass:"u-time"},[s._v(s._s(e.showTime))]),a("p",{staticClass:"u-desc"},[s._v(s._s(e.desc))]),e.ps?a("p",{staticClass:"u-desc"},[s._v(s._s("留言:"+e.ps))]):s._e()]),s.deleteIdServer!==e.idServer?a("div",{staticClass:"m-options",attrs:{slot:"default"},slot:"default"},["init"===e.state?[a("x-button",{attrs:{type:"primary",mini:!0,"action-type":"button"},nativeOn:{click:function(t){return s.handleTeamApply(e,!0)}}},[s._v("同意")]),a("x-button",{attrs:{type:"warn",mini:!0,"action-type":"button"},nativeOn:{click:function(t){return s.handleTeamApply(e,!1)}}},[s._v("拒绝")])]:a("div",{staticClass:"u-msg-state"},[s._v("\n                "+s._s("error"===e.state?"已过期":"rejected"===e.state?"已拒绝":"已同意")+"\n              ")])],2):s._e()]),a("span",{staticClass:"u-tag-del",class:{active:s.deleteIdServer===e.idServer},on:{click:function(t){return s.deleteMsg(e.idServer)}}})]):a("cell",{directives:[{name:"touch",rawName:"v-touch:swipeleft",value:s.showDelBtn,expression:"showDelBtn",arg:"swipeleft"},{name:"touch",rawName:"v-touch:swiperight",value:s.hideDelBtn,expression:"hideDelBtn",arg:"swiperight"}],key:e.idServer,staticClass:"u-list-item",attrs:{title:e.showText,value:e.showTime,"inline-desc":e.desc,idServer:e.idServer}},[a("img",{staticClass:"icon",attrs:{slot:"icon",width:"24",src:e.avatar},slot:"icon"}),a("span",{staticClass:"u-tag-del",class:{active:s.deleteIdServer===e.idServer},on:{click:function(t){return s.deleteMsg(e.idServer)}}})])]})],2),!s.msgList||s.msgList.length<1?a("div",{staticClass:"empty-hint"},[s._v("暂无任何消息")]):s._e()],1)],1)},[],!1,null,null,null);e.default=n.exports}}]);