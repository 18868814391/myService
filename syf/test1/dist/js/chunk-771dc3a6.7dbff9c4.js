(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-771dc3a6"],{"23f9":function(t,e,a){"use strict";a.r(e);var s={computed:{teamId:function(){return this.$route.params.teamId}},components:{TeamMember:(a("f61f"),a("86c6")).a}},n=(a("89c9"),a("2877")),r=Object(n.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"g-inherit m-article p-members"},[a("x-header",{staticClass:"m-tab",attrs:{"left-options":{backText:" "}}},[a("h1",{staticClass:"m-tab-top"},[t._v("群成员")]),a("a",{attrs:{slot:"left"},slot:"left"})]),a("team-member",{attrs:{teamId:t.teamId,advanced:!0,showAllMode:!0}})],1)},[],!1,null,"406c4b42",null);e.default=r.exports},3897:function(t,e,a){},"86c6":function(t,e,a){"use strict";var s=(a("ac6a"),a("5176")),r=a.n(s),n=(a("7514"),{props:{teamId:{type:String},advanced:{type:Boolean,default:!1},showAllMode:{type:Boolean,default:!1},filterAccount:{type:Array}},data:function(){return{removeMode:!1,hasManagePermission:!1,hasSearched:!1}},mounted:function(){void 0===this.$store.state.teamMembers[this.teamId]&&this.$store.dispatch("getTeamMembers",this.teamId)},computed:{teamInfo:function(){var e=this,t=this.$store.state.teamlist,a=t&&t.find(function(t){return t.teamId===e.teamId});if(a)return a},members:function(){var a=this,t=this.$store.state.teamMembers[this.teamId],s=this.$store.state.userInfos,n=[];if(t){if(t=t.map(function(t){var e=r()({},t);return e.valid=!0,e.account===a.$store.state.userUID?(e.alias="我",e.avatar=a.$store.state.myInfo.avatar,a.isOwner="owner"===e.type,a.hasManagePermission="normal"!==e.type):void 0===s[e.account]?(n.push(e.account),e.avatar=e.avatar||a.avatar,e.alias=e.nickInTeam||e.account):(e.avatar=s[e.account].avatar,e.alias=e.nickInTeam||s[e.account].nick),e}),0<n.length&&!this.hasSearched)for(this.hasSearched=!0;0<n.length;)this.searchUsers(n.splice(0,150));return t}return[]},membersInDisplay:function(){var t=this;return this.filterAccount?this.members.filter(function(e){return!!t.filterAccount.find(function(t){return t===e.account})}):this.advanced||this.showAllMode?this.members:this.members.slice(0,this.hasInvitePermission?3:4)},hasInvitePermission:function(){return this.advanced&&(this.hasManagePermission||this.teamInfo&&"all"===this.teamInfo.inviteMode)}},methods:{searchUsers:function(t){var e=this;this.$store.dispatch("searchUsers",{accounts:t,done:function(t){e.updateTeamMember(t)}})},updateTeamMember:function(t){var a=this;t.forEach(function(e){var t=a.members.find(function(t){return t.account===e.account});t&&(t.avatar=e.avatar,t.alias=t.nickInTeam||e.nick)})},triggerRemove:function(t,e){this.removeMode=!this.removeMode},remove:function(t,e){var a=this;this.$store.dispatch("showLoading"),this.$store.dispatch("delegateTeamFunction",{functionName:"removeTeamMembers",options:{teamId:this.teamId,accounts:[e.account],done:function(t,e){a.$toast("移除成功"),a.$store.dispatch("hideLoading")}}}),t.cancelBubble=!0,t.preventDefault()},onMemberClick:function(t){location.href=this.advanced?"#/teammembercard/".concat(t.id):"#/namecard/".concat(t.account)}}}),i=(a("9529"),a("2877")),c=Object(i.a)(n,function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("div",{staticClass:"m-members",class:{"s-bg-white":a.advanced&&!a.showAllMode}},[a.hasInvitePermission&&!a.showAllMode?s("a",{staticClass:"u-member",attrs:{href:"#/teaminvite/"+a.teamId}},[s("img",{staticClass:"avatar",attrs:{src:"http://yx-web.nos.netease.com/webdoc/h5/im/team_member_add.png",alt:""}}),s("span",[a._v("添加")])]):a._e(),a._l(a.membersInDisplay,function(e){return s("a",{key:e.account,staticClass:"u-member",on:{click:function(t){return a.onMemberClick(e)}}},[s("img",{staticClass:"avatar u-circle",attrs:{src:e.avatar}}),a.removeMode&&"owner"!=e.type&&e.account!=a.$store.state.userUID?s("span",{staticClass:"remove",on:{click:function(t){return a.remove(t,e)}}}):a._e(),"normal"!==e.type?s("span",{class:"manager"===e.type?"manager":"owner"}):a._e(),s("span",[a._v(a._s(e.alias))])])}),a.advanced?a._e():[s("a",{staticClass:"u-member",attrs:{href:"#/teaminvite/"+a.teamId}},[s("img",{staticClass:"avatar",attrs:{src:"http://yx-web.nos.netease.com/webdoc/h5/im/team_member_add.png",alt:""}}),s("span",[a._v("添加")])]),a.hasManagePermission?s("div",{staticClass:"u-member",on:{click:function(t){return a.triggerRemove()}}},[s("img",{staticClass:"avatar",attrs:{src:"http://yx-web.nos.netease.com/webdoc/h5/im/team_member_delete.png",alt:""}}),s("span",[a._v("移除")])]):a._e()]],2)},[],!1,null,"aad428f0",null);e.a=c.exports},"89c9":function(t,e,a){"use strict";var s=a("bde2");a.n(s).a},9529:function(t,e,a){"use strict";var s=a("3897");a.n(s).a},bde2:function(t,e,a){}}]);